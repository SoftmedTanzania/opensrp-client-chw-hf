---
name: step1_prep_initiation_date
description: prep_initiation_date calculation
priority: 1
condition: "step1_prep_status.equals('initiated')"
actions:
  - "calculation = helper.getDateToday()"
---
name: step1_maximum_date_for_next_visit
description: Calculate the maximum date for the next follow-up visit
priority: 1
condition: "step1_prep_pills_number != '' "
actions:
  - "def getMaximumDate(number_of_pills) {
        import java.util.*;
  
        int numberOfPills = number_of_pills;
        Calendar cal = Calendar.getInstance();
        cal.add(Calendar.DATE, numberOfPills + 3);
        
        SimpleDateFormat dateFormat = new SimpleDateFormat('dd-MM-yyyy', Locale.getDefault());
        return dateFormat.format(cal.getTime());
     }"
  - "calculation = getMaximumDate(step1_prep_pills_number)"
---
name: step1_minimum_date_for_next_visit
description: Calculate the minimum date for the next follow-up visit
priority: 1
condition: "step1_prep_pills_number != ''"
actions:
  - "def getMinimumDate(number_of_pills) {
        import java.util.*;
  
        int numberOfPills = number_of_pills;
        Calendar cal = Calendar.getInstance();
        cal.add(Calendar.DATE, numberOfPills - 3);
        
        SimpleDateFormat dateFormat = new SimpleDateFormat('dd-MM-yyyy', Locale.getDefault());
        return dateFormat.format(cal.getTime());
     }"
  - "calculation = getMinimumDate(step1_prep_pills_number)"